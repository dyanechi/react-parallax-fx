import t,{useState as e,useLayoutEffect as n,useCallback as r,useEffect as o,useContext as a,createContext as i}from"react";import{useInView as l}from"react-intersection-observer";import c from"styled-components";function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,l=!1;try{for(n=n.call(t);!(i=(r=n.next()).done)&&(a.push(r.value),!e||a.length!==e);i=!0);}catch(t){l=!0,o=t}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function m(t){var r=g(e(0),2),o=r[0],a=r[1];return n((function(){function e(){a(Math.floor(window.pageYOffset/t)*t)}return window.addEventListener("scroll",e),e(),function(){return window.removeEventListener("scroll",e)}}),[]),o}var y,b,w,S=function(t,e){if("number"==typeof t)return t;if("string"==typeof t){if(/[0-9]%$/g.test(t.toString()))return e?e*(parseInt(t)/100):parseInt(t)/100;if(/[0-9](px)$/g.test(t.toString()))return console.log("".concat(t," is in pixels!")),parseInt(t);if(/[0-9](em)$/g.test(t.toString()))return console.log("".concat(t," is in em!")),16*parseInt(t);if(/^[0-9](vh)$/g.test(t.toString()))return console.log("".concat(t," is in vh!")),parseInt(t)/100*window.innerHeight;if(/^[0-9](vw)$/g.test(t.toString()))return console.log("".concat(t," is in vw!")),parseInt(t)/100*window.innerWidth}return console.warn("Couldn't find any match for",t),0},F={TRANSFORM:["translate","translateX","translateY","scale","rotate"],FILTERS:["blur","brightness","contrast","grayscale","hueRotate","saturate","sepia","dropShadow"]},O=function(t){var e=[];if("string"==typeof t){if(/^#[0-9a-fA-F]{3}$/i.test(t)?t+="f":/^#[0-9a-fA-F]{6}$/i.test(t)&&(t+="ff"),/^#[0-9a-fA-F]{4}$/i.test(t))t.replace("#","").split(/(.)/g).filter((function(t){return t})).forEach((function(t){return e.push(17*Number("0x"+t))})),e[e.length-1]=e[e.length-1]/255;else{if(!/^#[0-9a-fA-F]{8}$/i.test(t))throw new Error("".concat(t," is invalid. 'Color' must be valid Hex or RGBA value. "));t.replace("#","").split(/(..)/g).filter((function(t){return t})).forEach((function(t){return e.push(Number("0x"+t))})),e[e.length-1]=e[e.length-1]/255}return e}return t},E=function(t,e,n,r){if(t===e)return t;var o=t<e?e*n+(t-t*n):t-t*n+e*n;return r?r(o):o},j=function(t,e,n){var r=O(t),o=O(e);return r.map((function(t,e){return E(t,o[e],n)}))},A=function(t,e){var n={transform:{},filter:{}};return Object.entries(t).forEach((function(r){var o,a,i=g(r,1)[0],l={};if("gradient"===i)l.gradient={type:t.gradient.type,dir:[t.gradient.dir||0,(null===(o=e.gradient)||void 0===o?void 0:o.dir)||t.gradient.dir],start:t.gradient.colors,end:(null===(a=e.gradient)||void 0===a?void 0:a.colors)||t.gradient.colors};else if(F.FILTERS.includes(i)){var c;l.filter=u(u({},n.filter),{},f({},i,[t[i]||0,(null!==(c=e[i])&&void 0!==c?c:t[i])||0]))}else if(F.TRANSFORM.includes(i)){var s,d,p,v,h;l.transform=u(u({},n.transform),{},f({},i,"translate"===i?[[t.translate[0],(null!==(s=null==e||null===(d=e.translate)||void 0===d?void 0:d[0])&&void 0!==s?s:t.translate[0])||0],[t.translate[1],(null!==(p=null==e||null===(v=e.translate)||void 0===v?void 0:v[1])&&void 0!==p?p:t.translate[1])||0]]:[t[i]||0,(null!==(h=e[i])&&void 0!==h?h:t[i])||0]))}else{var m;l=f({},i,[t[i],null!==(m=e[i])&&void 0!==m?m:t[i]])}n=u(u({},n),l)})),n},x=function(t){if(!t)throw new Error("Animation not provided or is empty");var e={start:0,length:0},n={start:0,length:0};return Object.keys(t).forEach((function(r){if("gradient"===r){var o=t.gradient;e.gradient={type:o.type,dir:o.dir[0],colors:o.start},n.gradient={type:o.type,dir:o.dir[1],colors:o.end}}else if("translate"===r)e.translate=t.translate[0],n.translate=t.translate[1];else if("length"===r)e.length=S(t.length[0]),n.length=S(t.length[1]);else{var a=t[r];e[r]=a[0],n[r]=a[1]}})),console.info("Converted frames: ",[e,n]),[e,n]},I=function(){var t=g(e({totalLength:0,frames:new Array,currentFrame:0,extend:!1,isInitialized:!1,ease:.1,easeFn:"linear",onChange:function(){}}),2),r=t[0],o=t[1];return n((function(){}),[r.frames]),{get:r,init:function(t,e,n){if(r.isInitialized);else{var a=new Array,i=0,l={};t.forEach((function(e,n){var r=n>=t.length-1?t[t.length-1]:t[n+1];Object.assign(l,e.hold?{}:r,e),a.push(u(u({},l),{},{start:i+e.start})),i+=e.length})),o(u(u({},r),{},{frames:a,totalLength:i,isInitialized:!0,easeFn:e||"linear"})),n&&n(i)}},getLength:function(){return r.totalLength},getFrames:function(){return r.frames},getCurrentFrame:function(t){var e=function(t){var e=r.frames,n=t*r.totalLength;if(n>e[e.length-1].start)return o(u(u({},r),{},{currentFrame:e.length-1})),e.length-1;if(n<e[0].length)return o(u(u({},r),{},{currentFrame:0})),0;if(n>e[r.currentFrame].start&&n<e[r.currentFrame].length)return r.currentFrame;var a=0,i=0,l=e.length-1,c=Math.floor((l+i)/2),s=!1;for(;!s&&i<=l&&a<10;){a++;var f=e[c],d=f.start,g=d+f.length;if(n<d?l=c-1:n>g&&(i=c+1),s=d<n&&n<g)return o(u(u({},r),{},{currentFrame:c})),c;c=Math.floor((l+i)/2)}return r.currentFrame}(t),n=e>=r.frames.length-2?r.frames.length-1:e+1,a=r.frames[e],i=r.frames[n],l=a.start/r.totalLength,c=l+a.length/r.totalLength,s=1/(c-l);return{curFrame:a,nextFrame:i,curProgress:"linear"===r.easeFn?s*t-c/(c-l)+1:(c-l)/(c-l)/(c-l)/(c-l)*(t-l)*(t-l)}},getAllFrames:function(){return r.frames},isInitialized:r.isInitialized}},T=function(t){var a=t.startScroll,i=t.endScroll,c=t.fadeIn,s=t.fadeOut,f=t.keyframes,d=t.offset,v=t.disabled,h=t.extend,y=t.ease,b=t.easeFn,w=t.onTransitionChange,F=l(),O=F.ref,T=F.inView,P=F.entry,H=null==P?void 0:P.target,z=m(1),k=g(e({startScroll:q(a||"bottom"),endScroll:i?S(i):300,scrollHeight:0,offsetTop:0}),2),L=k[0],C=k[1],N=I(),$=function(t,n,a,i,l){var c=g(e({current:0,previous:0,rounded:0,ease:Math.max(0,Math.min(1,null!=l?l:1))}),2),s=c[0],f=c[1],d=g(e({start:0,end:0,scrollHeight:0}),2),p=d[0],v=d[1],h=g(e({progress:0,isTransitioning:!1}),2),m=h[0],y=h[1],b=r((function(){f(u(u({},s),{},{current:a,previous:s.previous+(s.current-s.previous)*s.ease,rounded:Math.round(s.previous)}));var t=(s.rounded-p.start)/p.scrollHeight;y(u(u({},m),{},{progress:t<0?0:t>1?1:t,isTransitioning:!!(t>0&&t<1)}))}),[a,s.rounded]);return o((function(){requestAnimationFrame(b)}),[b]),o((function(){var e=t+(i||0),r=e+n,o=r-e;v(u(u({},p),{},{start:e,end:r,scrollHeight:o}))}),[t,n,i]),u(u({},m),{},{scrollHeight:p.scrollHeight})}(L.offsetTop,L.endScroll,L.startScroll+z,d,y),M=$.progress,R=$.isTransitioning;function q(t){var e=document.documentElement.clientHeight;return"top"===t?z:"center"===t?z+e/2:"bottom"===t?z+e:d||z+e}function Y(){for(var t=H.offsetTop,e=0,n=H.offsetParent;null!==n&&"BODY"!==n.tagName&&e<30;)t+=n.offsetTop,n=n.offsetParent,e++;return q(a||"top"),e>=30&&console.error("There is too much recursion within AnimationContainer component. Please check and fix if possible."),t}var D=function(){var t,e;H&&(H.style.background=function(t){if("string"==typeof t){if(0===t.length)return"";if(4===t.length?t+="f":7===t.length&&(t+="ff"),!/^#[0-9a-fA-F]{8}$/i.test(t)&&!/^#[0-9a-fA-F]{4}$/i.test(t))throw new Error("".concat(t," is invalid. 'Color' must be valid Hex or RGBA value. "))}return t}((null==c||null===(t=c.background)||void 0===t?void 0:t[0])||(null==s||null===(e=s.background)||void 0===e?void 0:e[0])||""),(f||c||s)&&requestAnimationFrame(G))};function X(t,e){var n=t.opacity,r=t.transform,o=t.background,a=t.gradient,i=t.filter,l=e;n&&(H.style.opacity=function(t,e){return E.apply(void 0,p(t).concat([e])).toFixed(3)}(p(n),l)).toString(),r&&(H.style.transform=function(t,e){var n=t.translate,r=t.translateX,o=t.translateY,a=t.scale,i=t.rotate,l="";if(n){var c=E.apply(void 0,p(n[0]).concat([e])),s=E.apply(void 0,p(n[1]).concat([e]));l+="translate(".concat(c,"px, ").concat(s,"px) ")}else r?l+="translateX(".concat(E.apply(void 0,p(r).concat([e])),"px) "):o&&(l+="translateY(".concat(E.apply(void 0,p(o).concat([e])),"px) "));return a&&(l+="scale(".concat(E.apply(void 0,p(a).concat([e])),") ")),i&&(l+="rotate(".concat(E.apply(void 0,p(i).concat([e])),"deg) ")),l}(u({},r),l)),o&&(H.style.backgroundColor=function(t,e){var n=j.apply(void 0,p(t).concat([e]));return"rgba(".concat(n.join(","),") ")}(p(o),l)),a&&(H.style.background=function(t,e){var n=t.type,r=t.dir,o=t.start,a=t.end;if(o.length<2||a.length<2)throw new Error("'start' and 'end' must have at least 2 elements");if(o.length!==a.length)throw new Error("'start' and 'end' array length must be the same");for(var i=[],l=0;l<o.length;l++){var c=j(o[l],a[l],e);i.push("rgba(".concat(c.join(","),")"))}var s=r&&"radial"!==n?E.apply(void 0,p(r).concat([e]))+"deg,":"";return"".concat(n&&n||"linear","-gradient(").concat(s).concat(i.join(","),")")}(u({},a),l)),i&&(H.style.filter=function(t,e){var n=t.blur,r=t.brightness,o=t.contrast,a=t.dropShadow,i=t.grayscale,l=t.hueRotate,c=t.opacity,s=t.saturate,u=t.sepia,f="";return n&&(f+="blur(".concat(E.apply(void 0,p(n).concat([e])),"px) ")),r&&(f+="brightness(".concat(E.apply(void 0,p(r).concat([e])),"%) ")),o&&(f+="contrast(".concat(E.apply(void 0,p(o).concat([e])),"%) ")),i&&(f+="grayscale(".concat(E.apply(void 0,p(i).concat([e])),"%) ")),l&&(f+="hue-rotate(".concat(E.apply(void 0,p(l).concat([e])),"deg) ")),c&&(f+="opacity(".concat(E.apply(void 0,p(c).concat([e])),"%) ")),s&&(f+="saturate(".concat(E.apply(void 0,p(s).concat([e])),"%) ")),u&&(f+="sepia(".concat(E.apply(void 0,p(u).concat([e])),"%) ")),a&&(f+="drop-shadow(".concat(E.apply(void 0,p(a).concat([e])),"px) ")),f}(u({},i),l))}function V(){if(N.isInitialized){var t=N.getCurrentFrame(M),e=t.curFrame,n=t.nextFrame,r=A(e,n);(isNaN(M)||M<=0)&&requestAnimationFrame((function(){return X(r,0)})),M>=1&&requestAnimationFrame((function(){return X(r,1)}))}}function B(){if(!N.isInitialized){var t=new Array;Object.assign(t,f||function(){var t=new Array,e=x(c||[]),n=x(s||[]),r=Math.max(L.endScroll,H.offsetHeight,S((null==c?void 0:c.length)||0)+S((null==s?void 0:s.length)||0));if(c){var o=S(c.length,r);e[0].length=o,e[1].start=o,Object.assign(t,e)}if(s){var a=S(s.length,r);n[0]=u(u({},n[0]),{},{start:r-a,length:a}),n[1].start=r,e?e[1]=u(u({},e[1]),{},{length:r-a}):n=[{start:0,length:r-a}].concat(p(n)),t=[].concat(p(t),p(n))}return t}());var e=t.map((function(t){return u(u({},t),{},{start:0,length:S(t.length,H.offsetHeight)})}));if(e.length<2)throw new Error("Must provide at least 2 keyframes");N.init(e,b,(function(t){h&&t>L.scrollHeight?(C(u(u({},L),{},{scrollHeight:t,endScroll:t,offsetTop:Y()})),H&&window.addEventListener("resize",(function(){return U(t,t)}))):H&&window.addEventListener("resize",(function(){return U(L.endScroll,t)})),requestAnimationFrame(V)}))}}function G(){if(!N.isInitialized)return B();var t=N.getCurrentFrame(M),e=t.curFrame,n=t.nextFrame,r=t.curProgress,o=A(e,n);requestAnimationFrame((function(){return X(o,r)}))}var U=function(t,e){C(u(u({},L),{},{endScroll:t,scrollHeight:e,startScroll:q(a||"bottom"),offsetTop:Y()}))};return n((function(){!v&&R&&N.isInitialized&&requestAnimationFrame(G)}),[M,R,N.isInitialized,v]),n((function(){H&&requestAnimationFrame(V),w&&w()}),[R,w,H,N.isInitialized]),o((function(){D()}),[H]),o((function(){}),[]),{ref:O,status:{isTransitioning:R,inView:T}}},P=function(n){var r=n.startScroll,a=n.endScroll,i=n.speed,c=n.opacity,s=n.transform,f=n.offset,d=n.background,v=n.gradient,h=n.filter,y=n.disabled,b=n.className,w=n.children,S=l({}),F=S.ref,O=S.inView,A=S.entry,x=null==A?void 0:A.target,I=m(1),T=g(e(0),2),P=T[0],H=T[1],z=function(t){switch(t){case"top":return document.documentElement.scrollTop;case"center":return+document.documentElement.scrollTop+document.documentElement.clientHeight/2;case"bottom":return+document.documentElement.scrollTop+document.documentElement.clientHeight;default:return t||+document.documentElement.scrollTop+document.documentElement.clientHeight}},k=g(e({startScroll:z(r||"top"),endScroll:a?a.toString().includes("%")?1e3:parseInt(a.toString()):300,speed:(i||20)/100}),2),L=k[0],C=k[1],N=function(){if(x){var t=x.offsetParent.offsetTop+(f||0),e=t+L.endScroll-t,n=(L.startScroll+I-t)/e;H(n<0?0:n>1?1:n)}},$=function(){if(x){if(c){var t=E.apply(void 0,p(c).concat([P]));x.style.opacity=t.toFixed(3)}if(d){var e=j.apply(void 0,p(d).concat([P]));x.style.backgroundColor="rgba(".concat(e.join(","),") ")}else if(v){var n=v.type,r=v.dir,o=v.start,a=v.end;if(o.length<2||a.length<2)throw new Error("'start' and 'end' must have at least 2 elements");if(o.length!==a.length)throw new Error("'start' and 'end' array length must be the same");for(var i=[],l=0;l<o.length;l++){var u=j(o[l],a[l],P);i.push("rgba(".concat(u.join(","),")"))}var f=r&&"radial"!==n?E.apply(void 0,p(r).concat([P]))+"deg,":"";console.log(n,r,o,a),console.log("".concat(n&&n||"linear","-gradient(").concat(f).concat(i.join(" "),")")),x.style.background="".concat(n&&n||"linear","-gradient(").concat(f).concat(i.join(","),")")}var g="";if(s){var m=s.translate,y=s.translateX,b=s.translateY,w=s.scale,S=s.rotate;if(m){var F=E.apply(void 0,p(m[0]).concat([P])),O=E.apply(void 0,p(m[1]).concat([P]));g+="translate(".concat(F,"px, ").concat(O,"px) ")}else y?g+="translateX(".concat(E.apply(void 0,p(y).concat([P])),"px) "):b&&(g+="translateY(".concat(E.apply(void 0,p(b).concat([P])),"px) "));w&&(g+="scale(".concat(E.apply(void 0,p(w).concat([P])),") ")),S&&(g+="rotate(".concat(E.apply(void 0,p(S).concat([P])),"deg) ")),""!==g&&(x.style.transform=g)}if(h){var A=E.apply(void 0,p(h.blur||[0,0]).concat([P]));x.style.filter="blur(".concat(A,"px) ")}}};o((function(){if(!y)return N(),function(){}}),[I]),o((function(){requestAnimationFrame($)}),[P]);var M=function(){C(u(u({},L),{},{startScroll:z(r||"top")}))};return o((function(){return function(){if(x){console.log(O);var t=null==a?void 0:a.toString(),e=t?t.includes("%")?parseInt(t)/100*x.offsetHeight:parseInt(t):x.offsetParent.offsetHeight;C(u(u({},L),{},{endScroll:e})),N(),$()}}(),function(){}}),[x]),o((function(){return H(0),window.addEventListener("resize",M),function(){return window.removeEventListener("resize",M)}}),[]),t.createElement("div",{style:{position:"relative",width:"100%",height:"fit-content"}},t.createElement("div",{ref:F,style:{position:"relative",width:"100%",height:"fit-content",willChange:"transform, opacity, background"},className:b},w&&"function"==typeof w?w({isTransitioning:P>0&&P<1,inView:O}):w))},H={startScroll:"bottom",ease:.1,easeFn:"linear",offset:0,extend:!0},z=i(H),k=function(e){var n=e.children,r=e.config;return t.createElement(z.Provider,{value:Object.assign({},H,r)},n)},L=["children","className"],C=c.div(y||(b=["\n  width: 100%;\n  height: fit-content;\n"],w||(w=b.slice(0)),y=Object.freeze(Object.defineProperties(b,{raw:{value:Object.freeze(w)}})))),N=function(e){var n=e.children,r=e.className,o=d(e,L),i=a(z),l=T(i?Object.assign({},i,u({},o)):u({},o)),c=l.ref,s=l.status;return t.createElement(C,{ref:c,className:r},n&&"function"==typeof n?n(s):n)};export{P as LegacyParallax,N as UseParallax,k as UseParallaxProvider,T as useParallax};
//# sourceMappingURL=index.js.map

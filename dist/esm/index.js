import*as t from"react";import e,{useState as n,useLayoutEffect as r,useCallback as o,useEffect as i}from"react";import a from"styled-components";function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const h=new Map,v=new WeakMap;let m,y=0;function b(t){return Object.keys(t).sort().filter((e=>void 0!==t[e])).map((e=>{return`${e}_${"root"===e?(n=t.root,n?(v.has(n)||(y+=1,v.set(n,y.toString())),v.get(n)):"0"):t[e]}`;var n})).toString()}function w(t,e,n={},r=m){if(void 0===window.IntersectionObserver&&void 0!==r){const o=t.getBoundingClientRect();return e(r,{isIntersecting:r,target:t,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:o,observer:i,elements:a}=function(t){let e=b(t),n=h.get(e);if(!n){const r=new Map;let o;const i=new IntersectionObserver((e=>{e.forEach((e=>{var n;const i=e.isIntersecting&&o.some((t=>e.intersectionRatio>=t));t.trackVisibility&&void 0===e.isVisible&&(e.isVisible=i),null==(n=r.get(e.target))||n.forEach((t=>{t(i,e)}))}))}),t);o=i.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:e,observer:i,elements:r},h.set(e,n)}return n}(n);let c=a.get(t)||[];return a.has(t)||a.set(t,c),c.push(e),i.observe(t),function(){c.splice(c.indexOf(e),1),0===c.length&&(a.delete(t),i.unobserve(t)),0===a.size&&(i.disconnect(),h.delete(o))}}function S({threshold:e,delay:n,trackVisibility:r,rootMargin:o,root:i,triggerOnce:a,skip:c,initialInView:l,fallbackInView:s,onChange:u}={}){const f=t.useRef(),d=t.useRef(),[g,p]=t.useState({inView:!!l});d.current=u;const h=t.useCallback((t=>{void 0!==f.current&&(f.current(),f.current=void 0),c||t&&(f.current=w(t,((t,e)=>{p({inView:t,entry:e}),d.current&&d.current(t,e),e.isIntersecting&&a&&f.current&&(f.current(),f.current=void 0)}),{root:i,rootMargin:o,threshold:e,trackVisibility:r,delay:n},s))}),[Array.isArray(e)?e.toString():e,i,o,a,c,r,s,n]);t.useEffect((()=>{f.current||!g.entry||a||c||p({inView:!!l})}));const v=[h,g.inView,g.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}function O(t){var e=f(n(0),2),o=e[0],i=e[1];return r((function(){function e(){i(Math.floor(window.pageYOffset/t)*t)}return window.addEventListener("scroll",e),e(),function(){return window.removeEventListener("scroll",e)}}),[]),o}var F,A,E,j=function(t,e){if("number"==typeof t)return t;if("string"==typeof t){if(/[0-9]%$/g.test(t.toString()))return e?e*(parseInt(t)/100):parseInt(t)/100;if(/[0-9](px)$/g.test(t.toString()))return console.log("".concat(t," is in pixels!")),parseInt(t);if(/[0-9](em)$/g.test(t.toString()))return console.log("".concat(t," is in em!")),16*parseInt(t);if(/^[0-9](vh)$/g.test(t.toString()))return console.log("".concat(t," is in vh!")),parseInt(t)/100*window.innerHeight;if(/^[0-9](vw)$/g.test(t.toString()))return console.log("".concat(t," is in vw!")),parseInt(t)/100*window.innerWidth}return console.warn("Couldn't find any match for",t),0},I={TRANSFORM:["translate","translateX","translateY","scale","rotate"],FILTERS:["blur","brightness","contrast","grayscale","hueRotate","saturate","sepia","dropShadow"]},x=function(t){var e=[];if("string"==typeof t){if(/^#[0-9a-fA-F]{3}$/i.test(t)?t+="f":/^#[0-9a-fA-F]{6}$/i.test(t)&&(t+="ff"),/^#[0-9a-fA-F]{4}$/i.test(t))t.replace("#","").split(/(.)/g).filter((function(t){return t})).forEach((function(t){return e.push(17*Number("0x"+t))})),e[e.length-1]=e[e.length-1]/255;else{if(!/^#[0-9a-fA-F]{8}$/i.test(t))throw new Error("".concat(t," is invalid. 'Color' must be valid Hex or RGBA value. "));t.replace("#","").split(/(..)/g).filter((function(t){return t})).forEach((function(t){return e.push(Number("0x"+t))})),e[e.length-1]=e[e.length-1]/255}return e}return t},k=function(t,e,n,r){if(t===e)return t;var o=t<e?e*n+(t-t*n):t-t*n+e*n;return r?r(o):o},H=function(t,e,n){var r=x(t),o=x(e);return r.map((function(t,e){return k(t,o[e],n)}))},T=function(t,e){var n={transform:{},filter:{}};return Object.entries(t).forEach((function(r){var o,i,a=f(r,1)[0],c={};if("gradient"===a)c.gradient={type:t.gradient.type,dir:[t.gradient.dir||0,(null===(o=e.gradient)||void 0===o?void 0:o.dir)||t.gradient.dir],start:t.gradient.colors,end:(null===(i=e.gradient)||void 0===i?void 0:i.colors)||t.gradient.colors};else if(I.FILTERS.includes(a)){var u;c.filter=l(l({},n.filter),{},s({},a,[t[a]||0,(null!==(u=e[a])&&void 0!==u?u:t[a])||0]))}else if(I.TRANSFORM.includes(a)){var d;c.transform=l(l({},n.transform),{},s({},a,[t[a]||0,(null!==(d=e[a])&&void 0!==d?d:t[a])||0]))}else c=s({},a,[t[a],e[a]]);n=l(l({},n),c)})),console.log("Merged",n,t,e),n},z=function(t){if(!t)throw new Error("Animation not provided or is empty");var e={start:0,length:0},n={start:0,length:0};return Object.keys(t).forEach((function(r){if("gradient"===r){var o=t.gradient;e.gradient={type:o.type,dir:o.dir[0],colors:o.start},n.gradient={type:o.type,dir:o.dir[1],colors:o.end}}else if("translate"===r)e.translate=t.translate[0],n.translate=t.translate[1];else if("length"===r)e.length=j(t.length[0]),n.length=j(t.length[1]);else{var i=t[r];e[r]=i[0],n[r]=i[1]}})),console.info("Converted frames: ",[e,n]),[e,n]},P=function(){var t=f(n({totalLength:0,frames:new Array,currentFrame:0,extend:!1,isInitialized:!1,easing:.1,onChange:function(){}}),2),e=t[0],o=t[1];return r((function(){console.info("frames updated")}),[e.frames]),{get:e,init:function(t,n){if(e.isInitialized)console.warn("useKeyframes 'config' is already initialized.");else{var r=new Array,i=0,a={};t.forEach((function(e,n){var o=n>=t.length-1?t[t.length-1]:t[n+1];Object.assign(a,e.hold?{}:o,e),r.push(l(l({},a),{},{start:i+e.start})),i+=e.length})),console.log(r),o(l(l({},e),{},{frames:r,totalLength:i,isInitialized:!0})),n&&n(i),console.log("'useKeyframe': initialized")}},getLength:function(){return e.totalLength},getFrames:function(){return e.frames},getCurrentFrame:function(t){var n=function(t){var n=e.frames,r=t*e.totalLength;if(r>n[n.length-1].start)return o(l(l({},e),{},{currentFrame:n.length-1})),n.length-1;if(r<n[0].length)return o(l(l({},e),{},{currentFrame:0})),0;if(r>n[e.currentFrame].start&&r<n[e.currentFrame].length)return e.currentFrame;var i=0,a=0,c=n.length-1,s=Math.floor((c+a)/2),u=!1;for(;!u&&a<=c&&i<10;){i++;var f=n[s],d=f.start,g=d+f.length;if(r<d?c=s-1:r>g&&(a=s+1),u=d<r&&r<g)return o(l(l({},e),{},{currentFrame:s})),s;s=Math.floor((c+a)/2)}return e.currentFrame}(t),r=n>=e.frames.length-2?e.frames.length-1:n+1,i=e.frames[n],a=e.frames[r],c=i.start/e.totalLength,s=c+i.length/e.totalLength;return{curFrame:i,nextFrame:a,curProgress:1/(s-c)*t-s/(s-c)+1}},getAllFrames:function(){return e.frames},isInitialized:e.isInitialized}},C=function(t){var e,a,c=t.startScroll,s=t.endScroll,u=t.fadeIn,g=t.fadeOut,p=t.keyframes,h=t.offset,v=t.disabled,m=t.extend,y=t.ease,b=t.onTransitionChange,w=S(),F=w.ref,A=w.inView,E=w.entry,I=null==E?void 0:E.target,x=O(1),C=f(n({startScroll:(e=c||"bottom",a=document.documentElement.clientHeight,"top"===e?x:"center"===e?x+a/2:"bottom"===e?x+a:h||x+a),endScroll:s?j(s):300,scrollHeight:0}),2),R=C[0],M=C[1],V=P(),$=function(t,e,r,a,c){var s=f(n({current:0,previous:0,rounded:0,ease:Math.max(0,Math.min(1,null!=c?c:1))}),2),u=s[0],d=s[1],g=f(n({start:0,end:0,scrollHeight:0}),2),p=g[0],h=g[1],v=f(n({progress:0,isTransitioning:!1}),2),m=v[0],y=v[1],b=o((function(){d(l(l({},u),{},{current:r,previous:u.previous+(u.current-u.previous)*u.ease,rounded:Math.round(u.previous)}));var t=(u.rounded-p.start)/p.scrollHeight;y(l(l({},m),{},{progress:t<0?0:t>1?1:t,isTransitioning:!!(t>0&&t<1)}))}),[r,u.rounded]);return i((function(){requestAnimationFrame(b)}),[b]),i((function(){var n=t+(a||0),r=n+e,o=r-n;h(l(l({},p),{},{start:n,end:r,scrollHeight:o}))}),[t,e,a]),l(l({},m),{},{scrollHeight:p.scrollHeight})}(I&&I.offsetTop||0,R.endScroll,R.startScroll+x,h,y),L=$.progress,N=$.isTransitioning;var q=function(){var t,e;I&&(I.style.background=function(t){if("string"==typeof t){if(0===t.length)return"";if(4===t.length?t+="f":7===t.length&&(t+="ff"),!/^#[0-9a-fA-F]{8}$/i.test(t)&&!/^#[0-9a-fA-F]{4}$/i.test(t))throw new Error("".concat(t," is invalid. 'Color' must be valid Hex or RGBA value. "))}return t}((null==u||null===(t=u.background)||void 0===t?void 0:t[0])||(null==u||null===(e=u.background)||void 0===e?void 0:e[0])||""),(p||u||g)&&requestAnimationFrame(D))};function Y(t,e){var n=t.opacity,r=t.transform,o=t.background,i=t.gradient,a=t.filter,c=e;n&&(I.style.opacity=function(t,e){return k.apply(void 0,d(t).concat([e])).toFixed(3)}(d(n),c)).toString(),r&&(I.style.transform=function(t,e){var n=t.translate,r=t.translateX,o=t.translateY,i=t.scale,a=t.rotate,c="";if(n){var l=k.apply(void 0,d(n[0]).concat([e])),s=k.apply(void 0,d(n[1]).concat([e]));c+="translate(".concat(l,"px, ").concat(s,"px) ")}else r?c+="translateX(".concat(k.apply(void 0,d(r).concat([e])),"px) "):o&&(c+="translateY(".concat(k.apply(void 0,d(o).concat([e])),"px) "));return i&&(c+="scale(".concat(k.apply(void 0,d(i).concat([e])),") ")),a&&(c+="rotate(".concat(k.apply(void 0,d(a).concat([e])),"deg) ")),c}(l({},r),c)),o&&(I.style.backgroundColor=function(t,e){var n=H.apply(void 0,d(t).concat([e]));return"rgba(".concat(n.join(","),") ")}(d(o),c)),i&&(I.style.background=function(t,e){var n=t.type,r=t.dir,o=t.start,i=t.end;if(o.length<2||i.length<2)throw new Error("'start' and 'end' must have at least 2 elements");if(o.length!==i.length)throw new Error("'start' and 'end' array length must be the same");for(var a=[],c=0;c<o.length;c++){var l=H(o[c],i[c],e);a.push("rgba(".concat(l.join(","),")"))}var s=r&&"radial"!==n?k.apply(void 0,d(r).concat([e]))+"deg,":"";return"".concat(n&&n||"linear","-gradient(").concat(s).concat(a.join(","),")")}(l({},i),c)),a&&(I.style.filter=function(t,e){var n=t.blur,r=t.brightness,o=t.contrast,i=t.dropShadow,a=t.grayscale,c=t.hueRotate,l=t.opacity,s=t.saturate,u=t.sepia,f="";return n&&(f+="blur(".concat(k.apply(void 0,d(n).concat([e])),"px) ")),r&&(f+="brightness(".concat(k.apply(void 0,d(r).concat([e])),"%) ")),o&&(f+="contrast(".concat(k.apply(void 0,d(o).concat([e])),"%) ")),a&&(f+="grayscale(".concat(k.apply(void 0,d(a).concat([e])),"%) ")),c&&(f+="hue-rotate(".concat(k.apply(void 0,d(c).concat([e])),"deg) ")),l&&(f+="opacity(".concat(k.apply(void 0,d(l).concat([e])),"%) ")),s&&(f+="saturate(".concat(k.apply(void 0,d(s).concat([e])),"%) ")),u&&(f+="sepia(".concat(k.apply(void 0,d(u).concat([e])),"%) ")),i&&(f+="drop-shadow(".concat(k.apply(void 0,d(i).concat([e])),"px) ")),f}(l({},a),c))}function X(){if(V.isInitialized){var t=V.getCurrentFrame(L),e=t.curFrame,n=t.nextFrame,r=T(e,n);(isNaN(L)||L<=0)&&requestAnimationFrame((function(){return Y(r,0)})),L>=1&&requestAnimationFrame((function(){return Y(r,1)}))}}function B(){if(!V.isInitialized){var t=new Array;Object.assign(t,p||function(){var t=new Array,e=z(u||[]),n=z(g||[]),r=Math.max(R.endScroll,I.offsetHeight,j((null==u?void 0:u.length)||0)+j((null==g?void 0:g.length)||0));if(e){var o=j(u.length,r);e[0].length=o,e[1].start=o,Object.assign(t,e)}if(n){var i=j(g.length,r);n[0]=l(l({},n[0]),{},{start:r-i,length:i}),n[1].start=r,e?e[1]=l(l({},e[1]),{},{length:r-i}):n=[{start:0,length:r-i}].concat(d(n)),t=[].concat(d(t),d(n))}return t}());var e=t.map((function(t){return l(l({},t),{},{start:0,length:j(t.length,I.offsetHeight)})}));V.init(e,(function(t){m&&t>R.scrollHeight&&M(l(l({},R),{},{scrollHeight:t,endScroll:t})),requestAnimationFrame(X)}))}}function D(){if(!V.isInitialized)return B();var t=V.getCurrentFrame(L),e=t.curFrame,n=t.nextFrame,r=t.curProgress,o=T(e,n);requestAnimationFrame((function(){return Y(o,r)}))}return r((function(){!v&&N&&V.isInitialized&&requestAnimationFrame(D),console.log(L)}),[L,N,V.isInitialized,v]),r((function(){console.info("Transitioning changed to: ",N),I&&requestAnimationFrame(X),b&&b()}),[N,b,I,V.isInitialized]),i((function(){return q()}),[I]),i((function(){}),[]),{ref:F,status:{isTransitioning:N,inView:A}}},R=function(t){var r=t.startScroll,o=t.endScroll,a=t.speed,c=t.opacity,s=t.transform,u=t.offset,g=t.background,p=t.gradient,h=t.filter,v=t.disabled,m=t.className,y=t.children,b=S({}),w=b.ref,F=b.inView,A=b.entry,E=null==A?void 0:A.target,j=O(1),I=f(n(0),2),x=I[0],T=I[1],z=function(t){switch(t){case"top":return document.documentElement.scrollTop;case"center":return+document.documentElement.scrollTop+document.documentElement.clientHeight/2;case"bottom":return+document.documentElement.scrollTop+document.documentElement.clientHeight;default:return t||+document.documentElement.scrollTop+document.documentElement.clientHeight}},P=f(n({startScroll:z(r||"top"),endScroll:o?o.toString().includes("%")?1e3:parseInt(o.toString()):300,speed:(a||20)/100}),2),C=P[0],R=P[1],M=function(){if(E){var t=E.offsetParent.offsetTop+(u||0),e=t+C.endScroll-t,n=(C.startScroll+j-t)/e;T(n<0?0:n>1?1:n)}},V=function(){if(E){if(c){var t=k.apply(void 0,d(c).concat([x]));E.style.opacity=t.toFixed(3)}if(g){var e=H.apply(void 0,d(g).concat([x]));E.style.backgroundColor="rgba(".concat(e.join(","),") ")}else if(p){var n=p.type,r=p.dir,o=p.start,i=p.end;if(o.length<2||i.length<2)throw new Error("'start' and 'end' must have at least 2 elements");if(o.length!==i.length)throw new Error("'start' and 'end' array length must be the same");for(var a=[],l=0;l<o.length;l++){var u=H(o[l],i[l],x);a.push("rgba(".concat(u.join(","),")"))}var f=r&&"radial"!==n?k.apply(void 0,d(r).concat([x]))+"deg,":"";console.log(n,r,o,i),console.log("".concat(n&&n||"linear","-gradient(").concat(f).concat(a.join(" "),")")),E.style.background="".concat(n&&n||"linear","-gradient(").concat(f).concat(a.join(","),")")}var v="";if(s){var m=s.translate,y=s.translateX,b=s.translateY,w=s.scale,S=s.rotate;if(m){var O=k.apply(void 0,d(m[0]).concat([x])),F=k.apply(void 0,d(m[1]).concat([x]));v+="translate(".concat(O,"px, ").concat(F,"px) ")}else y?v+="translateX(".concat(k.apply(void 0,d(y).concat([x])),"px) "):b&&(v+="translateY(".concat(k.apply(void 0,d(b).concat([x])),"px) "));w&&(v+="scale(".concat(k.apply(void 0,d(w).concat([x])),") ")),S&&(v+="rotate(".concat(k.apply(void 0,d(S).concat([x])),"deg) ")),""!==v&&(E.style.transform=v)}if(h){var A=k.apply(void 0,d(h.blur||[0,0]).concat([x]));E.style.filter="blur(".concat(A,"px) ")}}};i((function(){if(!v)return M(),function(){}}),[j]),i((function(){requestAnimationFrame(V)}),[x]);var $=function(){R(l(l({},C),{},{startScroll:z(r||"top")}))};return i((function(){return function(){if(E){console.log(F);var t=null==o?void 0:o.toString(),e=t?t.includes("%")?parseInt(t)/100*E.offsetHeight:parseInt(t):E.offsetParent.offsetHeight;R(l(l({},C),{},{endScroll:e})),M(),V()}}(),function(){}}),[E]),i((function(){return T(0),window.addEventListener("resize",$),function(){return window.removeEventListener("resize",$)}}),[]),e.createElement("div",{style:{position:"relative",width:"100%",height:"fit-content"}},e.createElement("div",{ref:w,style:{position:"relative",width:"100%",height:"fit-content",willChange:"transform, opacity, background"},className:m},y&&"function"==typeof y?y({isTransitioning:x>0&&x<1,inView:F}):y))},M=["children","className"],V=a.div(F||(A=["\n  width: 100%;\n  height: fit-content;\n"],E||(E=A.slice(0)),F=Object.freeze(Object.defineProperties(A,{raw:{value:Object.freeze(E)}})))),$=function(t){var n=t.children,r=t.className,o=u(t,M),i=C(l({},o)),a=i.ref,c=i.status;return e.createElement(V,{ref:a,className:r},n&&"function"==typeof n?n(c):n)};export{R as Parallax,$ as UseParallax,x as getRGBA,C as useParallax};
//# sourceMappingURL=index.js.map

import*as t from"react";import e,{useState as n,useLayoutEffect as r,useEffect as o}from"react";import i from"styled-components";function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const p=new Map,m=new WeakMap;let h,v=0;function y(t){return Object.keys(t).sort().filter((e=>void 0!==t[e])).map((e=>{return`${e}_${"root"===e?(n=t.root,n?(m.has(n)||(v+=1,m.set(n,v.toString())),m.get(n)):"0"):t[e]}`;var n})).toString()}function b(t,e,n={},r=h){if(void 0===window.IntersectionObserver&&void 0!==r){const o=t.getBoundingClientRect();return e(r,{isIntersecting:r,target:t,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:o,observer:i,elements:a}=function(t){let e=y(t),n=p.get(e);if(!n){const r=new Map;let o;const i=new IntersectionObserver((e=>{e.forEach((e=>{var n;const i=e.isIntersecting&&o.some((t=>e.intersectionRatio>=t));t.trackVisibility&&void 0===e.isVisible&&(e.isVisible=i),null==(n=r.get(e.target))||n.forEach((t=>{t(i,e)}))}))}),t);o=i.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:e,observer:i,elements:r},p.set(e,n)}return n}(n);let c=a.get(t)||[];return a.has(t)||a.set(t,c),c.push(e),i.observe(t),function(){c.splice(c.indexOf(e),1),0===c.length&&(a.delete(t),i.unobserve(t)),0===a.size&&(i.disconnect(),p.delete(o))}}function w({threshold:e,delay:n,trackVisibility:r,rootMargin:o,root:i,triggerOnce:a,skip:c,initialInView:l,fallbackInView:s,onChange:u}={}){const f=t.useRef(),d=t.useRef(),[g,p]=t.useState({inView:!!l});d.current=u;const m=t.useCallback((t=>{void 0!==f.current&&(f.current(),f.current=void 0),c||t&&(f.current=b(t,((t,e)=>{p({inView:t,entry:e}),d.current&&d.current(t,e),e.isIntersecting&&a&&f.current&&(f.current(),f.current=void 0)}),{root:i,rootMargin:o,threshold:e,trackVisibility:r,delay:n},s))}),[Array.isArray(e)?e.toString():e,i,o,a,c,r,s,n]);t.useEffect((()=>{f.current||!g.entry||a||c||p({inView:!!l})}));const h=[m,g.inView,g.entry];return h.ref=h[0],h.inView=h[1],h.entry=h[2],h}function S(t){var e=u(n(0),2),o=e[0],i=e[1];return r((function(){function e(){i(Math.floor(window.pageYOffset/t)*t)}return window.addEventListener("scroll",e),e(),function(){return window.removeEventListener("scroll",e)}}),[]),o}var E,O,I,j={TRANSFORM:["translate","translateX","translateY","scale","rotate"],FILTERS:["blur","brightness","contrast","grayscale","hueRotate","saturate","sepia","dropShadow"]},F=function(t){var e=[];if("string"==typeof t){if(4===t.length?t+="f":7===t.length&&(t+="ff"),/^#[0-9a-fA-F]{8}$/i.test(t))t.replace("#","").split(/(..)/g).filter((function(t){return t})).forEach((function(t){return e.push(Number("0x"+t))})),e[e.length-1]=e[e.length-1]/255;else{if(!/^#[0-9a-fA-F]{4}$/i.test(t))throw new Error("".concat(t," is invalid. 'Color' must be valid Hex or RGBA value. "));t.replace("#","").split(/(.)/g).filter((function(t){return t})).forEach((function(t){return e.push(17*Number("0x"+t))})),e[e.length-1]=e[e.length-1]/255}return e}return t},x=function(t,e,n,r){if(t===e)return t;var o=t<e?e*n+(t-t*n):t-t*n+e*n;return r?r(o):o},A=function(t,e,n){var r=F(t),o=F(e);return r.map((function(t,e){return x(t,o[e],n)}))},T=function(t,e,n,r,o){var i=t+(r||0),a=i+e-i;if(a<=0)throw new Error("'scrollHeight' must be greater than zero");var c=(n-i)/a,l=c<0?0:c>1?1:c;return o&&o({isTransitioning:!!(l>0&&l<1),result:l,scrollHeight:a}),l},H=function(t,e){if("number"==typeof t)return t;if("string"==typeof t){if(/[0-9]%$/g.test(t.toString()))return e?e*(parseInt(t)/100):parseInt(t)/100;if(/[0-9](px)$/g.test(t.toString()))return console.log("".concat(t," is in pixels!")),parseInt(t);if(/[0-9](em)$/g.test(t.toString()))return console.log("".concat(t," is in em!")),16*parseInt(t);if(/^[0-9](vh)$/g.test(t.toString()))return console.log("".concat(t," is in vh!")),parseInt(t)/100*window.innerHeight;if(/^[0-9](vw)$/g.test(t.toString()))return console.log("".concat(t," is in vw!")),parseInt(t)/100*window.innerWidth}return console.warn("Couldn't find any match for",t),0},k=function(){var t=u(n({totalLength:0,frames:new Array,currentFrame:0,extend:!1,isInitialized:!1,onChange:function(t){return 0}}),2),e=t[0],i=t[1],a=u(n(),2),l=a[0];a[1],o((function(){console.log("useKeyframes: frame changed to",l)}),[l]);r((function(){console.info("frames updated")}),[e.frames]);return{get:e,set:function(t){if(e.isInitialized)console.warn("useKeyframes 'config' is already initialized.");else{var n=0;t.forEach((function(t){return n+=H(t.length)})),i(c(c({},e),{},{frames:c({},t),totalLength:n}))}return console.log("'useKeyframe': config updated"),e},init:function(t,n){if(e.isInitialized)console.warn("useKeyframes 'config' is already initialized.");else{var r=new Array,o=0,a=0,l={},s={};t.forEach((function(t){Object.assign(s,t),r.push(c(c({},s),{},{start:o})),console.log(l,r[a-1],s,r[a]),Object.assign(l,s),o+=t.length,a++})),console.log(r),i(c(c({},e),{},{frames:r,totalLength:o,isInitialized:!0})),n&&n(o),console.log("'useKeyframe': initialized")}},getLength:function(){return e.totalLength},getFrames:function(){return e.frames},getCurrentFrame:function(t){var n=function(t){var n=e.frames,r=t*e.totalLength;if(r>n[n.length-1].start)return i(c(c({},e),{},{currentFrame:n.length-1})),n.length-1;if(r<n[0].length)return i(c(c({},e),{},{currentFrame:0})),0;if(r>n[e.currentFrame].start&&r<n[e.currentFrame].length)return e.currentFrame;var o=0,a=0,l=n.length-1,s=Math.floor((l+a)/2),u=!1;for(;!u&&a<=l&&o<10;){o++;var f=n[s],d=f.start,g=d+f.length;if(r<d?l=s-1:r>g&&(a=s+1),u=d<r&&r<g)return i(c(c({},e),{},{currentFrame:s})),s;s=Math.floor((l+a)/2)}return e.currentFrame}(t),r=n<=1?0:n>e.frames.length-2?e.frames.length-1:n-1,o=n>=e.frames.length-2?e.frames.length-1:n+1,a=e.frames[n];e.frames[r];var l=e.frames[o],s=a.start/e.totalLength,u=s+a.length/e.totalLength;return{curFrame:a,nextFrame:l,curProgress:1/(u-s)*t-u/(u-s)+1}},getAllFrames:function(){return e.frames},isInitialized:e.isInitialized}},z=["length","offset"],P=["length","offset"],R=function(t){var e=t.startScroll,i=t.endScroll,a=t.fadeIn,d=t.fadeOut,g=t.keyframes,p=t.offset,m=t.disabled,h=t.extend,v=t.callback,y=w(),b=y.ref,E=y.inView,O=y.entry,I=null==O?void 0:O.target,F=S(1),R=u(n(0),2),V=R[0],C=R[1],L=u(n({isTransitioning:!1,inView:E}),2),M=L[0],$=L[1],N=u(n({startScroll:function(t){switch(t){case"top":return document.documentElement.scrollTop;case"center":return+document.documentElement.scrollTop+document.documentElement.clientHeight/2;case"bottom":return+document.documentElement.scrollTop+document.documentElement.clientHeight;default:return t||+document.documentElement.scrollTop+document.documentElement.clientHeight}}(e||"bottom"),endScroll:i?H(i):300,scrollHeight:0}),2),q=N[0],Y=N[1],K=k();function X(t,e){var n=t.opacity,r=t.transform,o=t.background,i=t.gradient,a=t.filter,l=e;n&&(I.style.opacity=function(t,e){return x.apply(void 0,f(t).concat([e])).toFixed(3)}(f(n),l)).toString(),r&&(I.style.transform=function(t,e){var n=t.translate,r=t.translateX,o=t.translateY,i=t.scale,a=t.rotate,c="";if(n){var l=x.apply(void 0,f(n[0]).concat([e])),s=x.apply(void 0,f(n[1]).concat([e]));c+="translate(".concat(l,"px, ").concat(s,"px) ")}else r?c+="translateX(".concat(x.apply(void 0,f(r).concat([e])),"px) "):o&&(c+="translateY(".concat(x.apply(void 0,f(o).concat([e])),"px) "));return i&&(c+="scale(".concat(x.apply(void 0,f(i).concat([e])),") ")),a&&(c+="rotate(".concat(x.apply(void 0,f(a).concat([e])),"deg) ")),c}(c({},r),l)),o&&(I.style.backgroundColor=function(t,e){var n=A.apply(void 0,f(t).concat([e]));return"rgba(".concat(n.join(","),") ")}(f(o),l)),i&&(I.style.background=function(t,e){var n=t.type,r=t.dir,o=t.start,i=t.end;if(o.length<2||i.length<2)throw new Error("'start' and 'end' must have at least 2 elements");if(o.length!==i.length)throw new Error("'start' and 'end' array length must be the same");for(var a=[],c=0;c<o.length;c++){var l=A(o[c],i[c],e);a.push("rgba(".concat(l.join(","),")"))}var s=r&&"radial"!==n?x.apply(void 0,f(r).concat([e]))+"deg,":"";return"".concat(n&&n||"linear","-gradient(").concat(s).concat(a.join(","),")")}(c({},i),l)),a&&(I.style.filter=function(t,e){var n=t.blur,r=t.brightness,o=t.contrast,i=t.dropShadow,a=t.grayscale,c=t.hueRotate,l=t.opacity,s=t.saturate,u=t.sepia,d="";return n&&(d+="blur(".concat(x.apply(void 0,f(n).concat([e])),"px) ")),r&&(d+="brightness(".concat(x.apply(void 0,f(r).concat([e])),"%) ")),o&&(d+="contrast(".concat(x.apply(void 0,f(o).concat([e])),"%) ")),a&&(d+="grayscale(".concat(x.apply(void 0,f(a).concat([e])),"%) ")),c&&(d+="hue-rotate(".concat(x.apply(void 0,f(c).concat([e])),"deg) ")),l&&(d+="opacity(".concat(x.apply(void 0,f(l).concat([e])),"%) ")),s&&(d+="saturate(".concat(x.apply(void 0,f(s).concat([e])),"%) ")),u&&(d+="sepia(".concat(x.apply(void 0,f(u).concat([e])),"%) ")),i&&(d+="drop-shadow(".concat(x.apply(void 0,f(i).concat([e])),"px) ")),d}(c({},a),l))}function B(){var t={progress:a?0:d?1:0,animations:a||(d||{opacity:[1,1]})},e={progress:d?0:a?1:0,animations:d||(a||{opacity:[1,1]})};V<=0&&X(t.animations,t.progress),V>=1&&X(e.animations,e.progress)}function D(){var t=a.length,e=a.offset,n=s(a,z),r=W(H(t,I.offsetHeight),e),o=r.end,i=r.current/o/o,l=i<0?0:i>1?1:i;l>0&&l<1&&X(c({},n),l)}function G(){var t=d.length,e=d.offset,n=s(d,P),r=W(H(t,I.offsetHeight),e),o=r.end,i=r.current/o/o-(1-o)/o,a=i<0?0:i>1?1:i;a>0&&a<1&&X(c({},n),a)}function U(){if(!K.isInitialized)return function(){if(!K.isInitialized){var t=g.map((function(t){return c(c({},t),{},{start:0,length:H(t.length,I.offsetHeight)})}));K.init(t,(function(t){h&&t>q.scrollHeight&&Y(c(c({},q),{},{scrollHeight:t,endScroll:t}))}))}}();var t=K.getCurrentFrame(V),e=t.curFrame,n=t.nextFrame,r=t.curProgress,o=function(t,e){var n={transform:{},filter:{}};return Object.entries(t).forEach((function(r){var o=u(r,2),i=o[0];o[1];var a,s,f={};"gradient"===i?f.gradient={type:t.gradient.type,dir:[t.gradient.dir||0,(null===(a=e.gradient)||void 0===a?void 0:a.dir)||t.gradient.dir],start:t.gradient.colors,end:(null===(s=e.gradient)||void 0===s?void 0:s.colors)||t.gradient.colors}:j.FILTERS.includes(i)?f.filter=c(c({},n.filter),{},l({},i,[t[i]||0,e[i]||t[i]])):j.TRANSFORM.includes(i)?f.transform=c(c({},n.transform),{},l({},i,[t[i]||0,e&&e[i]||0])):f=l({},i,[t[i],e[i]]),n=c(c({},n),f)})),console.log("Merged",n),n}(e,n),i={};return"number"!=typeof e&&"number"!=typeof n&&(Object.entries(e).forEach((function(t){var r=u(t,2),o=r[0];r[1];var a=l({},o,[e[o],n[o]]);i=c(c({},i),a)})),console.log(i),requestAnimationFrame((function(){return X(o,r)}))),i}function W(t,e){var n=(e||0)/q.scrollHeight,r=t/q.scrollHeight+n;return{start:n,end:r,current:n+r*V}}o((function(){K.isInitialized&&console.info(K.getCurrentFrame(.6))}),[K.isInitialized]),o((function(){return!m&&I&&function(){var t=T(I.offsetTop,q.endScroll,q.startScroll+F,p,(function(t){var e=t.isTransitioning;$(c(c({},M),{},{isTransitioning:e}))}));C(t)}(),function(){}}),[F]),r((function(){M.isTransitioning&&(g?requestAnimationFrame(U):(a&&requestAnimationFrame(D),d&&requestAnimationFrame(G)))}),[V,M.isTransitioning,a,d,g]),r((function(){console.info("Transitioning changed to: ",M.isTransitioning),I&&requestAnimationFrame(B),v&&v()}),[M.isTransitioning,v]),o((function(){return $(c(c({},M),{},{inView:E}))}),[E]);var _=function(){if(I){var t=null==i?void 0:i.toString(),e=t?t.includes("%")?H(t)*I.offsetHeight:parseInt(t):I.offsetHeight;T(I.offsetTop,e,q.startScroll+F,p,(function(t){var n=t.isTransitioning,r=t.scrollHeight;$(c(c({},M),{},{isTransitioning:n})),Y(c(c({},q),{},{endScroll:e,scrollHeight:r})),B()})),I.style.background=function(t){if("string"==typeof t){if(0===t.length)return"";if(4===t.length?t+="f":7===t.length&&(t+="ff"),!/^#[0-9a-fA-F]{8}$/i.test(t)&&!/^#[0-9a-fA-F]{4}$/i.test(t))throw new Error("".concat(t," is invalid. 'Color' must be valid Hex or RGBA value. "))}return t}(a&&a.background&&a.background[0]||d&&d.background&&d.background[0]||""),g&&U()}};return o((function(){return _()}),[I]),o((function(){}),[]),{ref:b,status:M}},V=function(t){var r=t.startScroll,i=t.endScroll,a=t.speed,l=t.opacity,s=t.transform,d=t.offset,g=t.background,p=t.gradient,m=t.filter,h=t.disabled,v=t.className,y=t.children,b=w({}),E=b.ref,O=b.inView,I=b.entry,j=null==I?void 0:I.target,F=S(1),T=u(n(0),2),H=T[0],k=T[1],z=function(t){switch(t){case"top":return document.documentElement.scrollTop;case"center":return+document.documentElement.scrollTop+document.documentElement.clientHeight/2;case"bottom":return+document.documentElement.scrollTop+document.documentElement.clientHeight;default:return t||+document.documentElement.scrollTop+document.documentElement.clientHeight}},P=u(n({startScroll:z(r||"top"),endScroll:i?i.toString().includes("%")?1e3:parseInt(i.toString()):300,speed:(a||20)/100}),2),R=P[0],V=P[1],C=function(){if(j){var t=j.offsetParent.offsetTop+(d||0),e=t+R.endScroll-t,n=(R.startScroll+F-t)/e;k(n<0?0:n>1?1:n)}},L=function(){if(j){if(l){var t=x.apply(void 0,f(l).concat([H]));j.style.opacity=t.toFixed(3)}if(g){var e=A.apply(void 0,f(g).concat([H]));j.style.backgroundColor="rgba(".concat(e.join(","),") ")}else if(p){var n=p.type,r=p.dir,o=p.start,i=p.end;if(o.length<2||i.length<2)throw new Error("'start' and 'end' must have at least 2 elements");if(o.length!==i.length)throw new Error("'start' and 'end' array length must be the same");for(var a=[],c=0;c<o.length;c++){var u=A(o[c],i[c],H);a.push("rgba(".concat(u.join(","),")"))}var d=r&&"radial"!==n?x.apply(void 0,f(r).concat([H]))+"deg,":"";console.log(n,r,o,i),console.log("".concat(n&&n||"linear","-gradient(").concat(d).concat(a.join(" "),")")),j.style.background="".concat(n&&n||"linear","-gradient(").concat(d).concat(a.join(","),")")}var h="";if(s){var v=s.translate,y=s.translateX,b=s.translateY,w=s.scale,S=s.rotate;if(v){var E=x.apply(void 0,f(v[0]).concat([H])),O=x.apply(void 0,f(v[1]).concat([H]));h+="translate(".concat(E,"px, ").concat(O,"px) ")}else y?h+="translateX(".concat(x.apply(void 0,f(y).concat([H])),"px) "):b&&(h+="translateY(".concat(x.apply(void 0,f(b).concat([H])),"px) "));w&&(h+="scale(".concat(x.apply(void 0,f(w).concat([H])),") ")),S&&(h+="rotate(".concat(x.apply(void 0,f(S).concat([H])),"deg) ")),""!==h&&(j.style.transform=h)}if(m){var I=x.apply(void 0,f(m.blur||[0,0]).concat([H]));j.style.filter="blur(".concat(I,"px) ")}}};o((function(){if(!h)return C(),function(){}}),[F]),o((function(){requestAnimationFrame(L)}),[H]);var M=function(){V(c(c({},R),{},{startScroll:z(r||"top")}))};return o((function(){return function(){if(j){console.log(O);var t=null==i?void 0:i.toString(),e=t?t.includes("%")?parseInt(t)/100*j.offsetHeight:parseInt(t):j.offsetParent.offsetHeight;V(c(c({},R),{},{endScroll:e})),C(),L()}}(),function(){}}),[j]),o((function(){return k(0),window.addEventListener("resize",M),function(){return window.removeEventListener("resize",M)}}),[]),e.createElement("div",{style:{position:"relative",width:"100%",height:"fit-content"}},e.createElement("div",{ref:E,style:{position:"relative",width:"100%",height:"fit-content",willChange:"transform, opacity, background"},className:v},y&&"function"==typeof y?y({isTransitioning:H>0&&H<1,inView:O}):y))},C=["children","className"],L=i.div(E||(O=["\n  width: 100%;\n  height: fit-content;\n"],I||(I=O.slice(0)),E=Object.freeze(Object.defineProperties(O,{raw:{value:Object.freeze(I)}})))),M=function(t){var n=t.children,r=t.className,o=s(t,C),i=R(c({},o)),a=i.ref,l=i.status;return e.createElement(L,{ref:a,className:r},n&&"function"==typeof n?n(l):n)};export{V as Parallax,M as UseParallax,F as getRGBA,R as useParallax};
//# sourceMappingURL=index.js.map
